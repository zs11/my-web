---
title: "函数式编程"
date: "2020-02-13"
permalink: "notes/2020-02-13-function-programming"
---

⚡<strong>「内容速览」</strong>⚡

- 函数式编程五个特点
- 什么是函数式编程思维？
- 声明式和命令式
- 函数式编程的好处
- 函数式编程的应用

### 函数式编程五个特点

1. 函数是"第一等公民"

函数与其他数据类型一样，处于平等地位，可以赋值给其他变量，也可以作为参数，传入另一个函数，或者作为别的函数的返回值。

2. 只用”表达式”，不用”语句”

“表达式”（expression）是一个单纯的运算过程，总是有返回值；”语句”（statement）是执行某种操作，没有返回值。函数式编程要求，只使用表达式，不使用语句。也就是说，每一步都是单纯的运算，而且都有返回值。

3. 没有”副作用”

所谓”副作用”（side effect），指的是函数内部与外部互动（最典型的情况，就是修改全局变量的值），产生运算以外的其他结果。函数式编程强调没有”副作用”，意味着函数要保持独立，所有功能就是返回一个新的值，没有其他行为，尤其是不得修改外部变量的值。

4. 不修改状态

上一点已经提到，函数式编程只是返回新的值，不修改系统变量。因此，不修改变量，也是它的一个重要特点。在其他类型的语言中，变量往往用来保存”状态”（state）。不修改变量，意味着状态不能保存在变量中。函数式编程使用参数保存状态，最好的例子就是递归。

5. 引用透明

引用透明（Referential transparency），指的是函数的运行不依赖于外部变量或"状态"，只依赖于输入的参数，任何时候只要参数相同，引用函数所得到的返回值总是相同的。

### 什么是函数式编程思维？

除了函数式编程，我们最常用的方式是命令式编程。

函数式编程与命令式编程最大的不同其实在于：

函数式编程关心数据的映射，命令式编程关心解决问题的步骤

这里的映射就是数学上「函数」的概念——一种东西和另一种东西之间的对应关系，这也是为什么「函数式编程」叫做「函数」式编程。

命令式编程——你要做什么事情，你得把达到目的的步骤详细的描述出来，然后交给机器去运行。

例如翻转二叉树，命令式编程首先判断节点是否为空；然后翻转左树；然后翻转右树；最后左右互换。而函数式编程做是要得到一颗和原来二叉树对称的新二叉树，实现旧树到新树的映射，终达到的目的同样，只是方式不同。

### 声明式和命令式
命令式代码的意思就是，我们通过编写一条又一条指令去让计算机执行一些动作，这其中一般都会涉及到很多繁杂的细节。

而声明式就要优雅很多了，我们通过写表达式的方式来声明我们想干什么，而不是通过一步一步的指示。

```js
//命令式
var CEOs = [];
for(var i = 0; i < companies.length; i++){
    CEOs.push(companies[i].CEO)
}

//声明式
var CEOs = companies.map(c => c.CEO);
```
命令式的写法要先实例化一个数组，然后再对 companies 数组进行for循环遍历，手动命名、判断、增加计数器.

声明式的写法是一个表达式，如何进行计数器迭代，返回的数组如何收集，这些细节都隐藏了起来。它指明的是做什么，而不是怎么做。除了更加清晰和简洁之外，map 函数还可以进一步独立优化，甚至用解释器内置的速度极快的 map 函数。

**函数式编程的一个明显的好处就是这种声明式的代码，对于无副作用的纯函数，我们完全可以不考虑函数内部是如何实现的，专注于编写业务代码。优化代码时，目光只需要集中在这些稳定坚固的函数内部即可。**

**相反，不纯的不函数式的代码会产生副作用或者依赖外部系统环境，使用它们的时候总是要考虑这些不干净的副作用。**


### 函数式编程的好处

1. 最直观的角度来说，函数式风格的代码可以写得很精简。

2. 函数式的代码是“对映射的描述”，它的抽象程度可以很高，这就意味着函数式的代码可以更方便的复用。

### 函数式编程的应用

- 纯函数

纯函数的定义是，对于相同的输入，永远会得到相同的输出，而且没有任何可观察的副作用，也不依赖外部环境的状态。

为什么函数式编程会排斥不纯的函数呢？下面再看一个例子：
```js
//不纯的
var min = 18;
var checkage = age => age > min;

//纯的，这很函数式
var checkage = age => age > 18;
```
在不纯的版本中，checkage 这个函数的行为不仅取决于输入的参数 age，还取决于一个外部的变量 min，换句话说，这个函数的行为需要由外部的系统环境决定。对于大型系统来说，这种对于外部状态的依赖是造成系统复杂性大大提高的主要原因。

纯函数不仅可以有效降低系统的复杂度，还有很多很棒的特性，比如可缓存性。

- 函数的柯里化

函数柯里化（curry）的定义很简单：传递给函数一部分参数来调用它，让它返回一个函数去处理剩下的参数。

checkage 的函数柯里化
```js
var checkage = min => (age => age > min);
var checkage18 = checkage(18);
checkage18(20);
// =>true
```


参考链接：

[什么是函数式编程思维？](https://www.zhihu.com/question/28292740)

[JavaScript函数式编程（一）](https://zhuanlan.zhihu.com/p/21714695)